\documentclass[11pt,a4 paper,one side]{article}
\usepackage{amsmath,amssymb,graphicx}
\usepackage{ctex}  
\usepackage[colorlinks=true,linkcolor=red,citecolor=red,filecolor=magenta,urlcolor=cyan]{hyperref}
\usepackage{bookmark}
\usepackage{fontspec}
\setmainfont{Times New Roman}
\usepackage{xcolor}
\usepackage{geometry}
\geometry{a4paper, left=2.5cm, right=2.5cm, top=2.5cm, bottom=2.5cm}
\title{Allen-Cahn方程数值格式设计}
\date{\today}
\author{蒋鹏}
\begin{document}
\maketitle
\tableofcontents
\section{算法设计}
我们欲求解下述方程\begin{equation}
    \frac{\partial u}{\partial t}- \varepsilon^2 \Delta u + f(u) = 0;
\end{equation}
\\ 求解区域为$\Omega = [-1,1]^2$。初值条件为$u(x,y,0) = u_0(x,y)$。其中$f(u)$是非线性$f(u) = \log{\frac{u}{1-u}}+\theta (1-2u)=g(u)+\theta (1-2u)$.再定义$F(u) = u\log{u}+(1-u)\log{(1-u)}+\theta (u-u^2)$.
\\利用时间向后Euler，空间五点差分格式 \begin{equation}
    \frac{u^{n+1}-u^n}{dt} - \varepsilon^2 \Delta_h u^{n+1} + f(u^{n+1})=0;
\end{equation}
做一步凸分裂格式\begin{equation}
    \frac{u^{n+1}-u^n}{dt} - \varepsilon^2 \Delta_h u^{n+1} + g(u^{n+1}) +\theta (1-2u^n)=0;
\end{equation}
定义泛函\begin{equation}
    J(u) = \frac{\|u-u^n\|^2}{2dt}+ \int_{\Omega} ( \frac{1}{2}(\varepsilon^2 |\nabla u|^2 ) + G(u) ) dx + \theta <u,1-2u^n>;
\end{equation}
于是格式等价于\begin{equation}
    u^{n+1} = \arg \min_{u \in V_h} J(u);
\end{equation}
定义\begin{equation}
    F_1(u) = \frac{\|u-u^n\|^2}{2dt} + \int_{\Omega} (\frac{1}{2}(\varepsilon^2 |\nabla u|^2 )) dx
\end{equation}
和$F_2(u) =  \int_{\Omega} G(u) dx + \theta <u,1-2u^n>$.进而有$J(u) = F_1(u)+F_2(u)$。原格式等价于\begin{equation}
    \min_{u_1,u_2} F_1(u_1) + F_2(u_2), \quad s.t. \quad u_1=u_2;
\end{equation}
于是有二次罚函数\begin{equation}
    L(u_1,u_2;Y) = F_1(u_1) + F_2(u_2) + <Y,u_1-u_2> + \frac{\rho}{2}\|u_1-u_2\|^2;
\end{equation}
得到ADMM格式\begin{equation}
    \begin{cases}
        u_1^{k+1} = \arg \min_{u_1} L(u_1,u_2^k;Y^k) \\
        u_2^{k+1} = \arg \min_{u_2} L(u_1^{k+1},u_2;Y^k) \\
        Y^{k+1} = Y^k + \tau \rho (u_1^{k+1}-u_2^{k+1})
    \end{cases}
\end{equation}
第一个子问题有显式解，可以用CG或者FFT\begin{equation}
    (\frac{1}{dt}-\varepsilon^2 \Delta_h + \rho)u_1^{k+1} = \frac{1}{dt}u^n + \rho u_2^k - Y^k;
\end{equation}
第二个子问题的解满足\begin{equation}
    \log (\frac{u_2^{k+1}}{1-u_2^{k+1}})+\theta (1-2u^n) - Y^k -\rho (u_1^{k+1}-u_2^{k+1})=0;
\end{equation}
\subsection{法一：近似}
$u_2^{k+1} \approx u_2^k$,\begin{equation}
    u_2^{k+1} = 1 - \frac{1}{1+\exp{ (y^k-\theta (1-2u^n)+\rho (u_1^{k+1}-u_2^k))}}
\end{equation}
\subsection{法二：Newton}
以$0.5$分界，找到初始迭代点保证局部凹凸性后用Newton迭代。
\section{数值算例}
\subsection{算例一}取初值函数\begin{equation}
u_0(x,y)=\frac{1+\sin{2\pi x}\sin {2\pi y}}{3}
\end{equation}
和参数$\theta = 4.0$.用上述算法求解，发现效果良好，可以得到预期结果。
\section{算法优势}
猜测：在引入并行计算的模式下，由于ADMM的$U_2$子问题天然并行，受网格尺度影响更小，在更小的网格尺度下会体现出加速优势，不同时间步长下可以通过调整罚函数因子改进运算速度
\par 结果记录；取$dt=1$，$Nx=Ny=1000$，计算一个时间步，并行化程序用16个计算核心：
\begin{table}
    \centering
    \begin{tabular}{c|c|c}
    算法&cpu\_time(s)&主迭代次数(次)\\
    \hline
    admm & 140.955 & admm:52\\
    \hline
    admm\_parallel & 27.179 & admm:71\\
    \hline
    newton & 277.254 & newton:1445\\
    \hline
    newton\_parallel & 30.301 & newton:1508
    \end{tabular}
    \caption{数值结果}
    \label{数值结果}
\end{table}
\\ 问题：采取的protection边界保护策略是否有道理？
\end{document}